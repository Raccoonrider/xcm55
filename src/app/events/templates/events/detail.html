{% extends 'base.html' %}

{% load static %}

{% block head_title %}
    {{ event.get_display_name }}
{% endblock head_title %}

{% block css %}
    <link href="{% static 'app/css/hero.css' %}" rel="stylesheet">
    <link href="{% static 'app/css/cover.css' %}" rel="stylesheet">

    <style>       
        .cover {
          background-image: 
            linear-gradient(to bottom, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.5)),
            url("{% static 'app/img/cover.webp' %}");
          background-position: 50% 38%;
          background-size:cover;

        }
    </style>
{% endblock css %}

{% block cover %}
<h1 class="h-cover display-4 fw-bold lh-1 mb-3">
    Кросс-кантри Краб марафон
</h1>
{% endblock cover %}

{% block body %}
    <div class="container-md">  
    <p class="lead m-5 text-center">
        {{ event.description }}
    </p>
    <hr>

        {% with image='app/img/marathon.webp' header='Марафон' text=marathon.description button_text='Скачать трек' button_href=marathon.gpx.url button_secondary_text='Смотреть карту' button_secondary_href=marathon.map_embed_src %}
            {% include 'hero-right.html'%}
        {% endwith %}

        <hr>

        {% with image='app/img/half-marathon.webp' header='Полумарафон' text=halfmarathon.description button_text='Скачать трек' button_href=halfmarathon.gpx.url button_secondary_text='Смотреть карту' button_secondary_href=halfmarathon.map_embed_src %}
            {% include 'hero-left.html'%}
        {% endwith %}

        <hr>

        {% with image='app/img/elite.webp' header='Категория "Элита"' button_text='Зарегистрироваться' button_hide=registration_disabled button_href=event.application_url text="Элита - сильнейшие атлеты. В этой категории участвуют люди с профессиональным спортивным опытом, уверенные в своих силах и обладающие отличным скиллом владения велосипедом. Для элиты предусмотрена только одна соревновательная категория - абсолютный зачет - и только одна дистанция - марафон."%}
            {% include 'hero-right.html'%}
        {% endwith %}

        <hr>
        
        {% with image='app/img/amateur.webp' header='Категория "Любители"' button_text='Зарегистрироваться' button_hide=registration_disabled button_href=event.application_url text='Спорту, как и любви, все возрасты покорны. Не важно, 20 Вам или 60, в категории "Любители" Вы всегда сможете найти себе соперников по силам и посоревноваться с ними за призовые места в возрастной группе.' %}
            {% include 'hero-left.html'%}
        {% endwith %}

        <hr>
        
        {% with image='app/img/medals.webp' header='Награждение' button_text='Зарегистрироваться' button_hide=registration_disabled button_href=event.application_url text='Участники, преодолевшие дистанцию в пределах контрольного времени, будут награждены медалями финишера. Победители в категории "Элита" и лучшие в своих возрастных группах "Любители" будут дополнительно награждены на церемонии награждения медалями и ценными призами от наших спонсоров.' %}
        {% include 'hero-right.html'%}
        {% endwith %}

        <hr>

        {% with image='app/img/judge.webp' header='Правила' button_text='Скачать регламент' button_href=event.rules_doc.url text="Подробнее о правилах и проведении любительской кросс-кантри велогонки можно узнать в регламенте мероприятия."%}
            {% include 'hero-left.html'%}
        {% endwith %}

    </div>


    {% if payment_window_active %}
    <div class="text-light bg-success shadow-lg">  
        <div class="container-md row flex-lg-row align-items-center text-center py-5 mx-auto">
            <h1 class="display-5 fw-bold lh-1" id="pricing">
                Стоимость участия
            </h1>
            <p class="lead mx-auto my-4 mb-md-5">
                Оплачивая стартовый слот заранее, вы не только экономите, но и помогаете организаторам эффективно планировать мероприятие. 
            </p>

            <ul class="list-unstyled mx-0">
                {% for payment_window in payment_windows_stale %}
                <li class="text-decoration-line-through">
                    <strong>{{ payment_window.render_price }}</strong> при оплате до {{ payment_window.render_date }}
                </li>
                {% endfor %}
                <hr class="w-50 mx-auto">
                <li class="fs-2">
                    <strong>{{ payment_window_active.render_price }}</strong> при оплате до {{ payment_window_active.render_date }}
                </li>
                <hr class="w-50 mx-auto">
                {% for payment_window in payment_windows_next %}
                    {% if payment_window == payment_windows_next.0 %}
                        <li class="fs-4">
                            <strong>{{ payment_window.render_price }}</strong> при оплате до {{ payment_window.render_date }}
                        </li>
                    {% else %}
                        <li>
                            <strong>{{ payment_window.render_price }}</strong> при оплате до {{ payment_window.render_date }}
                        </li>
                    {% endif %}
                {% endfor %}
            </ul>
        </div>
    </div>
    {% endif %}

    <div class="container-md">          
        {% if elites or amateurs %}
            <div class="row flex-lg-row align-items-center g-5 py-5">
                <h1 class="display-5 fw-bold lh-1 text-center" id="participants">
                    Участвуют
                </h1>
                {% if elites %}
                    <div class="col-lg-6">
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item fs-3 fw-bolder">Категория "Элита"</li>
                            {% for application in elites %}
                            <li class="list-group-item fs-5">
                                {% if application == my_application %}
                                <strong>
                                    {{ application.user_profile }}
                                </strong>
                                {% else %}
                                    {{ application.user_profile }}
                                {% endif %}
                            </li>
                            {% endfor %}
                        </ul>
                    </div>
                {% endif %}
                {% if amateurs %}
                    <div class="col-lg-6">
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item fs-3 fw-bolder">Категория "Любители"</li>
                            {% for application in amateurs %}
                            <li class="list-group-item fs-5">
                                {% if application == my_application %}
                                <strong>
                                    {{ application.user_profile }}
                                </strong>
                                {% else %}
                                    {{ application.user_profile }}
                                {% endif %}
                            </li>
                            {% endfor %}
                        </ul>
                    </div>
                {% endif %}
            </div>
            {% if my_application %}
                {% if not my_application.payment_confirmed %}
                    <div 
                        hx-get="{% url 'hx_event_payment_info' event.id %}"
                        hx-swap="outerHTML"
                        hx-trigger="revealed"
                        id="payment_info">
                    ></div>
                {% else %}
                <div class="alert alert-success mb-4 fs-5">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-check-square-fill" viewBox="0 0 16 16">
                        <path d="M2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2zm10.03 4.97a.75.75 0 0 1 .011 1.05l-3.992 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425a.75.75 0 0 1 1.08-.022z"/>
                    </svg>
                    Ваша заявка на участие успешно оплачена. До встречи на старте!           
                </div>
                {% endif %}
            {% endif %}
        {% endif %}

        {% if event.sponsors.all %}
            <section class="py-5">
                <div class="text-center">
                    <h1 class="display-5 fw-bold lh-1">
                        Наши спонсоры
                    </h1>
                    <p class="lead mx-auto my-4 mb-md-5">
                        Выражаем искреннюю благодарность нашим спонсорам за помощь в подготовке стартов
                    </p>
                </div>
                    <hr class="w-50 mx-auto">
            
                <div class="container overflow-hidden">
                    <div class="row gy-5 gy-md-6">
                        {% for s in event.sponsors.all %}
                        <div class="col-4 col-md-3 align-self-center text-center">
                            <a href="{{ s.xref }}" target="_blank">
                                <img class="m-4 rounded shadow" width="300" height="150" src="{{ s.image.url }}"/>
                            </a>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </section>

        {% endif %}
    </div>
    
{% endblock body %}